<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grimório Digital - Mascote</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Inter:wght@300;400;500&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        cinzel: ['Cinzel', 'serif'],
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        theme: {
                            bg: '#0a0a0c',
                            panel: '#0f0f12',
                            border: '#2a2a2e',
                            text: '#e8e4dc',
                            pink: '#ec4899',
                            red: '#dc2626',
                            purple: '#8b5cf6',
                            yellow: '#f59e0b',
                            blue: '#4a9eff',
                            green: '#22c55e',
                            cyan: '#06b6d4',
                            orange: '#ff6b35',
                            teal: '#14b8a6',
                            indigo: '#6366f1',
                            muted: '#606060'
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #0a0a0c; color: #e8e4dc; }
        
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }

        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal-content {
            background: #0f0f12;
            border: 1px solid #2a2a2e;
            border-radius: 0.75rem;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: fadeIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .stat-bar {
            height: 0.5rem;
            background-color: #1a1a1a;
            border-radius: 9999px;
            overflow: hidden;
        }

        .stat-bar-fill {
            height: 100%;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .skill-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .skill-tag:hover {
            transform: translateY(-1px);
        }

        textarea { 
            resize: none; 
            min-height: 100px;
        }

        .type-card {
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .type-card:hover {
            transform: translateY(-2px);
        }

        .type-card.selected {
            border-color: currentColor;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        .anim-entry { animation: fadeInUp 0.6s ease-out forwards; opacity: 0; }
        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.2s; }
        .delay-3 { animation-delay: 0.3s; }
        .delay-4 { animation-delay: 0.4s; }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .profile-image-container {
            width: 120px;
            height: 120px;
            border: 3px solid #ec4899;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            background: #0f0f12;
        }

        .profile-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .image-upload-btn {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .image-upload-btn:hover {
            background: rgba(236, 72, 153, 0.8);
        }

        .import-export-btns {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .feedback-mascote {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            animation: slideInRight 0.3s ease-out;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body class="min-h-screen font-sans pb-12">

    <!-- Modal de Importar TXT -->
    <div id="import-modal" class="modal-backdrop hidden">
        <div class="modal-content">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="font-cinzel font-bold text-xl text-white">Importar Mascote</h3>
                    <button onclick="closeImportModal()" class="text-theme-muted hover:text-white transition-colors">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
                
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-400 mb-2">Cole o conteúdo TXT aqui:</label>
                    <textarea id="import-textarea" rows="10"
                        class="w-full px-4 py-3 bg-theme-bg border border-theme-border rounded-lg text-white placeholder-gray-500 focus:border-theme-pink focus:outline-none"
                        placeholder="Cole o conteúdo do arquivo TXT exportado..."></textarea>
                </div>
                
                <div class="flex gap-3">
                    <button onclick="closeImportModal()" class="flex-1 px-4 py-3 border border-theme-border rounded-lg text-theme-text hover:bg-white/5 transition-colors">
                        Cancelar
                    </button>
                    <button onclick="processImport()" class="flex-1 px-4 py-3 bg-gradient-to-r from-theme-green to-green-600 rounded-lg text-white font-semibold hover:opacity-90 transition-opacity">
                        <i data-lucide="upload" class="w-4 h-4 inline mr-2"></i>
                        Importar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Confirmação -->
    <div id="confirm-modal" class="modal-backdrop hidden">
        <div class="modal-content p-6">
            <div class="flex items-center gap-3 mb-4">
                <i data-lucide="alert-circle" class="w-10 h-10 text-theme-orange"></i>
                <h3 class="font-cinzel font-bold text-xl text-white" id="confirm-title">Confirmar Ação</h3>
            </div>
            
            <p class="text-gray-300 mb-6" id="confirm-message">
                Tem certeza que deseja realizar esta ação?
            </p>
            
            <div class="flex gap-3">
                <button onclick="closeConfirmModal(false)" 
                    class="flex-1 px-4 py-3 border border-theme-border rounded-lg text-theme-text hover:bg-white/5 transition-colors">
                    Cancelar
                </button>
                <button onclick="closeConfirmModal(true)" id="confirm-action-btn"
                    class="flex-1 px-4 py-3 bg-gradient-to-r from-theme-orange to-red-600 rounded-lg text-white font-semibold hover:opacity-90 transition-opacity">
                    <i data-lucide="check" class="w-4 h-4 inline mr-2"></i>
                    Confirmar
                </button>
            </div>
        </div>
    </div>

    <!-- Modal de Imagem -->
    <div id="image-modal" class="modal-backdrop hidden">
        <div class="modal-content" style="max-width: 600px;">
            <div class="p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="font-cinzel font-bold text-xl text-white">Imagem do Mascote</h3>
                    <button onclick="closeImageModal()" class="text-theme-muted hover:text-white transition-colors">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
                
                <div class="text-center mb-6">
                    <div class="profile-image-container mx-auto" style="width: 200px; height: 200px;">
                        <img id="image-preview" src="" alt="Preview" class="profile-image">
                        <div class="image-upload-btn" onclick="document.getElementById('image-input').click()">
                            <i data-lucide="camera" class="w-4 h-4 inline mr-1"></i>
                            Alterar Imagem
                        </div>
                    </div>
                    <input type="file" id="image-input" accept="image/*" class="hidden" onchange="handleImageUpload(event)">
                </div>
                
                <div class="text-sm text-gray-400 mb-4">
                    <p>Dicas:</p>
                    <ul class="list-disc pl-5 mt-2 space-y-1">
                        <li>Use imagens com proporção quadrada para melhor resultado</li>
                        <li>Tamanho ideal: 400x400 pixels</li>
                        <li>Formatos suportados: JPG, PNG, GIF</li>
                    </ul>
                </div>
                
                <div class="flex gap-3">
                    <button onclick="removeImage()" class="flex-1 px-4 py-3 border border-red-500/30 rounded-lg text-red-400 hover:bg-red-500/10 transition-colors">
                        <i data-lucide="trash-2" class="w-4 h-4 inline mr-2"></i>
                        Remover Imagem
                    </button>
                    <button onclick="closeImageModal()" class="flex-1 px-4 py-3 bg-gradient-to-r from-theme-pink to-purple-600 rounded-lg text-white font-semibold hover:opacity-90 transition-opacity">
                        <i data-lucide="check" class="w-4 h-4 inline mr-2"></i>
                        Salvar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- CONTEÚDO PRINCIPAL -->
    <div id="print-area">
        
        <nav class="w-full bg-[#0f0f12]/95 backdrop-blur-sm border-b border-theme-border sticky top-0 z-50 mb-8">
            <div class="max-w-7xl mx-auto px-4 flex items-center justify-between py-4">
                <div class="flex items-center gap-4">
                    <a href="index.html" class="text-theme-text hover:text-theme-pink transition-colors">
                        <i data-lucide="arrow-left" class="w-5 h-5"></i>
                    </a>
                    <div class="h-6 w-[1px] bg-theme-border"></div>
                    <span class="font-cinzel font-bold text-lg tracking-wide text-theme-pink">Grimório Digital</span>
                    <div class="h-6 w-[1px] bg-theme-border"></div>
                    <span class="text-sm text-theme-muted">Mascote</span>
                </div>
                
                <div class="flex items-center gap-3" id="nav-buttons">
                    <button onclick="openImageModal()" 
                        class="flex items-center gap-2 px-3 py-2 text-sm bg-theme-pink/20 hover:bg-theme-pink/30 text-theme-pink border border-theme-pink/30 rounded transition-colors">
                        <i data-lucide="image" class="w-4 h-4"></i>
                        <span class="hidden sm:inline">Imagem</span>
                    </button>
                </div>
            </div>
            <div class="h-[1px] bg-gradient-to-r from-transparent via-theme-pink to-transparent"></div>
        </nav>

        <div class="max-w-6xl mx-auto px-4 space-y-6">

            <!-- Cabeçalho com Imagem -->
            <header class="flex items-center justify-between mb-6 anim-entry">
                <div class="flex items-center gap-4">
                    <div class="profile-image-container cursor-pointer" onclick="openImageModal()">
                        <img id="mascote-image" src="" alt="Mascote" class="profile-image">
                        <div class="image-upload-btn">
                            <i data-lucide="camera" class="w-4 h-4 inline mr-1"></i>
                            Adicionar Imagem
                        </div>
                    </div>
                    <div>
                        <h1 class="text-3xl font-cinzel font-bold text-white">Mascote</h1>
                        <p class="text-gray-400">Companheiro independente</p>
                        <div class="import-export-btns">
                            <button onclick="importFromTXT()" class="text-xs px-3 py-1 bg-blue-900/30 text-blue-400 rounded border border-blue-800 hover:bg-blue-800/40 transition-colors">
                                <i data-lucide="upload" class="w-3 h-3 inline mr-1"></i>
                                Importar TXT
                            </button>
                            <button onclick="downloadTXT()" class="text-xs px-3 py-1 bg-green-900/30 text-green-400 rounded border border-green-800 hover:bg-green-800/40 transition-colors">
                                <i data-lucide="download" class="w-3 h-3 inline mr-1"></i>
                                Exportar TXT
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="text-right">
                    <div class="text-sm text-theme-muted mb-1">Sistema Independente</div>
                    <div class="font-cinzel font-bold text-theme-pink">Salvo Localmente</div>
                </div>
            </header>

            <!-- Seção 1: Identidade do Mascote -->
            <section class="bg-theme-panel border border-theme-border p-6 rounded-lg anim-entry delay-1" style="border-left: 4px solid #ec4899;">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="flex items-center gap-2 font-cinzel text-lg font-semibold text-theme-pink">
                        <i data-lucide="sparkles" class="w-4 h-4"></i> Identidade do Mascote
                    </h3>
                    <div class="text-xs text-gray-500">
                        Último salvamento: <span id="last-saved">Nunca</span>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Nome e Nível -->
                    <div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-400 mb-2">Nome do Mascote</label>
                            <input type="text" id="mascote-nome" placeholder="Ex: Fang, Luna, Ember" 
                                class="w-full px-4 py-3 bg-theme-bg border border-theme-border rounded-lg text-white placeholder-gray-500 focus:border-theme-pink focus:outline-none">
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-400 mb-2">Nível</label>
                            <div class="flex items-center gap-4">
                                <input type="number" id="mascote-nivel" min="1" max="100" value="1"
                                    class="w-20 px-4 py-3 bg-theme-bg border border-theme-border rounded-lg text-white text-center focus:border-theme-pink focus:outline-none">
                                <div class="text-sm text-gray-500">Determina a potência geral do mascote</div>
                            </div>
                            <div id="nivel-display" class="mt-2 text-xs text-gray-500 hidden">
                                <span class="text-theme-pink">Poder estimado: </span><span id="poder-estimado">0</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Tipo de Criatura -->
                    <div>
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-400">Tipo de Criatura</label>
                            <div id="tipo-criaturas" class="grid grid-cols-3 gap-3 mt-2">
                                <div class="type-card flex flex-col items-center justify-center p-3 rounded-lg cursor-pointer opacity-70 hover:opacity-100"
                                     onclick="selectTipoCriatura('canino')"
                                     style="background: #0a0a0c; border-color: #f59e0b;">
                                    <div class="w-10 h-10 rounded-full mb-2 flex items-center justify-center" style="background: #f59e0b40; color: #f59e0b">
                                        <i data-lucide="dog" class="w-5 h-5"></i>
                                    </div>
                                    <span class="text-xs text-center" style="color: #f59e0b">Canino</span>
                                </div>
                                <div class="type-card flex flex-col items-center justify-center p-3 rounded-lg cursor-pointer opacity-70 hover:opacity-100"
                                     onclick="selectTipoCriatura('felino')"
                                     style="background: #0a0a0c; border-color: #8b5cf6;">
                                    <div class="w-10 h-10 rounded-full mb-2 flex items-center justify-center" style="background: #8b5cf640; color: #8b5cf6">
                                        <i data-lucide="cat" class="w-5 h-5"></i>
                                    </div>
                                    <span class="text-xs text-center" style="color: #8b5cf6">Felino</span>
                                </div>
                                <div class="type-card flex flex-col items-center justify-center p-3 rounded-lg cursor-pointer opacity-70 hover:opacity-100"
                                     onclick="selectTipoCriatura('ave')"
                                     style="background: #0a0a0c; border-color: #4a9eff;">
                                    <div class="w-10 h-10 rounded-full mb-2 flex items-center justify-center" style="background: #4a9eff40; color: #4a9eff">
                                        <i data-lucide="bird" class="w-5 h-5"></i>
                                    </div>
                                    <span class="text-xs text-center" style="color: #4a9eff">Ave</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seção 2: Status e Atributos -->
            <section class="bg-theme-panel border border-theme-border p-6 rounded-lg anim-entry delay-2" style="border-left: 4px solid #8b5cf6;">
                <h3 class="flex items-center gap-2 font-cinzel text-lg font-semibold text-theme-purple mb-6">
                    <i data-lucide="activity" class="w-4 h-4"></i> Status e Atributos
                </h3>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Vida e Lealdade -->
                    <div class="space-y-6">
                        <!-- Vida -->
                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-sm font-medium text-gray-400">Vitalidade</label>
                                <span class="font-mono text-lg text-white" id="vida-display">50/50</span>
                            </div>
                            <div class="stat-bar">
                                <div id="vida-bar" class="stat-bar-fill bg-gradient-to-r from-red-600 to-red-400" style="width: 100%"></div>
                            </div>
                            <div class="grid grid-cols-2 gap-4 mt-2">
                                <input type="number" id="vida-atual" min="0" value="50" 
                                    class="w-full px-3 py-2 bg-theme-bg border border-theme-border rounded text-white text-center focus:border-red-500 focus:outline-none">
                                <input type="number" id="vida-max" min="1" value="50" 
                                    class="w-full px-3 py-2 bg-theme-bg border border-theme-border rounded text-white text-center focus:border-red-500 focus:outline-none">
                            </div>
                        </div>
                        
                        <!-- Lealdade -->
                        <div>
                            <div class="flex justify-between items-center mb-2">
                                <label class="text-sm font-medium text-gray-400">Lealdade</label>
                                <span class="font-mono text-lg text-white" id="lealdade-display">80%</span>
                            </div>
                            <div class="stat-bar">
                                <div id="lealdade-bar" class="stat-bar-fill bg-gradient-to-r from-yellow-600 to-yellow-400" style="width: 80%"></div>
                            </div>
                            <input type="range" id="input-lealdade" min="0" max="100" value="80" 
                                class="w-full mt-2 accent-yellow-500">
                        </div>
                    </div>
                    
                    <!-- Atributos -->
                    <div class="grid grid-cols-2 gap-4">
                        <!-- Agilidade -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-xs font-medium text-gray-400">Agilidade</label>
                                <span class="font-mono text-lg text-white" id="agilidade-display">70</span>
                            </div>
                            <input type="range" id="input-agilidade" min="0" max="100" value="70" 
                                class="w-full accent-blue-500">
                        </div>
                        
                        <!-- Força -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-xs font-medium text-gray-400">Força</label>
                                <span class="font-mono text-lg text-white" id="forca-display">60</span>
                            </div>
                            <input type="range" id="input-forca" min="0" max="100" value="60" 
                                class="w-full accent-red-500">
                        </div>
                        
                        <!-- Percepção -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-xs font-medium text-gray-400">Percepção</label>
                                <span class="font-mono text-lg text-white" id="percepcao-display">65</span>
                            </div>
                            <input type="range" id="input-percepcao" min="0" max="100" value="65" 
                                class="w-full accent-green-500">
                        </div>
                        
                        <!-- Defesa -->
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <label class="text-xs font-medium text-gray-400">Defesa</label>
                                <span class="font-mono text-lg text-white" id="defesa-display">55</span>
                            </div>
                            <input type="range" id="input-defesa" min="0" max="100" value="55" 
                                class="w-full accent-purple-500">
                        </div>
                    </div>
                </div>
            </section>

            <!-- Seção 3: Habilidades -->
            <section class="bg-theme-panel border border-theme-border p-6 rounded-lg anim-entry delay-3" style="border-left: 4px solid #4a9eff;">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="flex items-center gap-2 font-cinzel text-lg font-semibold text-theme-blue">
                        <i data-lucide="zap" class="w-4 h-4"></i> Habilidades
                    </h3>
                    <button onclick="addSkill()" class="flex items-center gap-2 px-3 py-2 bg-theme-blue/20 text-theme-blue text-xs rounded border border-theme-blue/30 hover:bg-theme-blue/30 transition-colors">
                        <i data-lucide="plus" class="w-3 h-3"></i>
                        Nova Habilidade
                    </button>
                </div>
                
                <!-- Lista de Habilidades -->
                <div id="skills-list" class="space-y-3">
                    <div class="text-center py-6 text-gray-500">
                        <i data-lucide="zap" class="w-8 h-8 mx-auto mb-2 opacity-50"></i>
                        <p>Nenhuma habilidade adicionada</p>
                        <p class="text-xs mt-1">Clique em "Nova Habilidade" para começar</p>
                    </div>
                </div>
            </section>

            <!-- Seção 4: Descrições -->
            <section class="bg-theme-panel border border-theme-border p-6 rounded-lg anim-entry delay-4" style="border-left: 4px solid #22c55e;">
                <h3 class="flex items-center gap-2 font-cinzel text-lg font-semibold text-theme-green mb-6">
                    <i data-lucide="file-text" class="w-4 h-4"></i> Descrições
                </h3>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Aparência -->
                    <div>
                        <label class="block text-sm font-medium text-gray-400 mb-2">
                            Aparência
                            <span class="text-xs text-gray-500 float-right">(<span id="char-count-aparencia">0</span>/500)</span>
                        </label>
                        <textarea id="mascote-aparencia" placeholder="Descreva a aparência física do seu mascote..." maxlength="500" rows="6"
                            class="w-full px-4 py-3 bg-theme-bg border border-theme-border rounded-lg text-white placeholder-gray-500 focus:border-theme-green focus:outline-none"></textarea>
                    </div>
                    
                    <!-- Personalidade -->
                    <div>
                        <label class="block text-sm font-medium text-gray-400 mb-2">
                            Personalidade
                            <span class="text-xs text-gray-500 float-right">(<span id="char-count-personalidade">0</span>/500)</span>
                        </label>
                        <textarea id="mascote-personalidade" placeholder="Como seu mascote se comporta? Quais são seus traços de personalidade?" maxlength="500" rows="6"
                            class="w-full px-4 py-3 bg-theme-bg border border-theme-border rounded-lg text-white placeholder-gray-500 focus:border-theme-green focus:outline-none"></textarea>
                    </div>
                </div>
            </section>

            <!-- Seção 5: História -->
            <section class="bg-theme-panel border border-theme-border p-6 rounded-lg anim-entry delay-4" style="border-left: 4px solid #f59e0b;">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="flex items-center gap-2 font-cinzel text-lg font-semibold text-theme-yellow">
                        <i data-lucide="book-open" class="w-4 h-4"></i> História
                    </h3>
                    <div class="text-xs text-gray-500">
                        <span id="char-count-historia">0</span>/2000 caracteres
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-400 mb-2">História do Mascote</label>
                    <textarea id="mascote-historia" placeholder="Como você encontrou seu mascote? Qual é a história dele?" maxlength="2000" rows="8"
                        class="w-full px-4 py-3 bg-theme-bg border border-theme-border rounded-lg text-white placeholder-gray-500 focus:border-theme-yellow focus:outline-none"></textarea>
                </div>
            </section>

        </div>
    </div>

    <!-- Rodapé com Ações -->
    <div class="max-w-6xl mx-auto px-4 mt-8 pb-12 flex flex-col md:flex-row justify-end gap-4 anim-entry">
        <button onclick="askReset()" 
                class="flex items-center justify-center gap-2 px-6 py-3 border border-theme-border rounded text-theme-text hover:bg-white/5 transition-colors font-cinzel text-sm">
            <i data-lucide="refresh-cw" class="w-4 h-4"></i>
            Resetar
        </button>
        
        <button onclick="saveLocal()" id="btn-save-local" 
                class="flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-theme-pink to-purple-600 rounded text-white shadow-lg hover:shadow-pink-500/20 transition-all font-cinzel text-sm font-bold">
            <i data-lucide="hard-drive" class="w-4 h-4"></i>
            Salvar Local
        </button>
    </div>

    <script>
        lucide.createIcons();

        // ====================================================================
        // DADOS GLOBAIS
        // ====================================================================
        let mascoteData = {
            tipoSelecionado: 'canino',
            skills: [],
            lastAutoSave: null,
            imageData: null
        };

        // Variável para confirmação
        let pendingAction = null;

        // ====================================================================
        // FUNÇÕES BÁSICAS
        // ====================================================================
        function selectTipoCriatura(tipo) {
            mascoteData.tipoSelecionado = tipo;
            document.querySelectorAll('.type-card').forEach(card => {
                card.classList.remove('selected');
                card.style.opacity = '0.7';
            });
            
            const selectedCard = document.querySelector(`[onclick="selectTipoCriatura('${tipo}')"]`);
            if (selectedCard) {
                selectedCard.classList.add('selected');
                selectedCard.style.opacity = '1';
            }
            
            autoSave();
        }

        function updateVida() {
            const atual = parseInt(document.getElementById('vida-atual').value) || 0;
            const max = parseInt(document.getElementById('vida-max').value) || 1;
            const percent = Math.min(100, (atual / max) * 100);
            
            document.getElementById('vida-display').textContent = `${atual}/${max}`;
            document.getElementById('vida-bar').style.width = `${percent}%`;
        }

        function updateLealdade() {
            const value = parseInt(document.getElementById('input-lealdade').value) || 0;
            document.getElementById('lealdade-display').textContent = `${value}%`;
            document.getElementById('lealdade-bar').style.width = `${value}%`;
        }

        function updateAgilidade() {
            const value = parseInt(document.getElementById('input-agilidade').value) || 0;
            document.getElementById('agilidade-display').textContent = value;
        }

        function updateForca() {
            const value = parseInt(document.getElementById('input-forca').value) || 0;
            document.getElementById('forca-display').textContent = value;
        }

        function updatePercepcao() {
            const value = parseInt(document.getElementById('input-percepcao').value) || 0;
            document.getElementById('percepcao-display').textContent = value;
        }

        function updateDefesa() {
            const value = parseInt(document.getElementById('input-defesa').value) || 0;
            document.getElementById('defesa-display').textContent = value;
        }

        function updateNivelDisplay() {
            const nivel = parseInt(document.getElementById('mascote-nivel').value) || 1;
            const poder = Math.floor(
                (parseInt(document.getElementById('input-lealdade').value) || 0) * 0.2 +
                (parseInt(document.getElementById('input-agilidade').value) || 0) * 0.2 +
                (parseInt(document.getElementById('input-forca').value) || 0) * 0.2 +
                (parseInt(document.getElementById('input-percepcao').value) || 0) * 0.2 +
                (parseInt(document.getElementById('input-defesa').value) || 0) * 0.2 +
                (nivel * 10)
            );
            
            const display = document.getElementById('nivel-display');
            const poderDisplay = document.getElementById('poder-estimado');
            
            if (display && poderDisplay) {
                display.classList.remove('hidden');
                poderDisplay.textContent = poder;
            }
        }

        function updateCharCounters() {
            const aparencia = document.getElementById('mascote-aparencia');
            const personalidade = document.getElementById('mascote-personalidade');
            const historia = document.getElementById('mascote-historia');
            
            if (aparencia) {
                document.getElementById('char-count-aparencia').textContent = aparencia.value.length;
            }
            if (personalidade) {
                document.getElementById('char-count-personalidade').textContent = personalidade.value.length;
            }
            if (historia) {
                document.getElementById('char-count-historia').textContent = historia.value.length;
            }
        }

        // ====================================================================
        // FUNÇÕES DE HABILIDADES
        // ====================================================================
        function addSkill() {
            const skill = {
                id: Date.now(),
                nome: `Habilidade ${mascoteData.skills.length + 1}`,
                descricao: 'Descrição da habilidade...',
                custo: 0
            };
            
            mascoteData.skills.push(skill);
            renderSkills();
            autoSave();
        }

        function removeSkill(id) {
            mascoteData.skills = mascoteData.skills.filter(skill => skill.id !== id);
            renderSkills();
            autoSave();
        }

        function renderSkills() {
            const container = document.getElementById('skills-list');
            if (!container) return;
            
            if (mascoteData.skills.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-6 text-gray-500">
                        <i data-lucide="zap" class="w-8 h-8 mx-auto mb-2 opacity-50"></i>
                        <p>Nenhuma habilidade adicionada</p>
                        <p class="text-xs mt-1">Clique em "Nova Habilidade" para começar</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            mascoteData.skills.forEach(skill => {
                const div = document.createElement('div');
                div.className = 'p-4 bg-theme-bg rounded-lg border border-theme-border';
                div.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div>
                            <input type="text" value="${skill.nome}" 
                                onchange="updateSkill(${skill.id}, 'nome', this.value)"
                                class="bg-transparent border-none text-white font-semibold focus:outline-none focus:border-b focus:border-theme-blue">
                            <div class="flex items-center gap-2 mt-1">
                                <span class="text-xs text-gray-500">Custo: <input type="number" min="0" value="${skill.custo}" 
                                    onchange="updateSkill(${skill.id}, 'custo', this.value)"
                                    class="w-10 bg-transparent border-none text-center text-white focus:outline-none"></span>
                            </div>
                        </div>
                        <button onclick="removeSkill(${skill.id})" class="text-red-500 hover:text-red-400 transition-colors">
                            <i data-lucide="trash-2" class="w-4 h-4"></i>
                        </button>
                    </div>
                    <textarea onchange="updateSkill(${skill.id}, 'descricao', this.value)" rows="2"
                        class="w-full bg-transparent border-none text-gray-300 text-sm resize-none focus:outline-none">${skill.descricao}</textarea>
                `;
                container.appendChild(div);
            });
            
            lucide.createIcons();
        }

        function updateSkill(id, field, value) {
            const skill = mascoteData.skills.find(s => s.id === id);
            if (skill) {
                skill[field] = value;
                autoSave();
            }
        }

        // ====================================================================
        // SISTEMA DE IMAGEM
        // ====================================================================
        function openImageModal() {
            const preview = document.getElementById('image-preview');
            if (mascoteData.imageData) {
                preview.src = mascoteData.imageData;
            } else {
                preview.src = '';
                preview.style.display = 'none';
            }
            document.getElementById('image-modal').classList.remove('hidden');
        }

        function closeImageModal() {
            document.getElementById('image-modal').classList.add('hidden');
        }

        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (!file.type.match('image.*')) {
                mostrarFeedback('Por favor, selecione um arquivo de imagem.', 'error');
                return;
            }
            
            if (file.size > 5 * 1024 * 1024) { // 5MB
                mostrarFeedback('A imagem é muito grande. Máximo: 5MB', 'error');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                mascoteData.imageData = e.target.result;
                
                // Atualizar previews
                const preview = document.getElementById('image-preview');
                preview.src = e.target.result;
                preview.style.display = 'block';
                
                const mainImage = document.getElementById('mascote-image');
                mainImage.src = e.target.result;
                mainImage.style.display = 'block';
                
                autoSave();
                mostrarFeedback('Imagem carregada com sucesso!', 'success');
            };
            reader.readAsDataURL(file);
        }

        function removeImage() {
            if (confirm('Tem certeza que deseja remover a imagem?')) {
                mascoteData.imageData = null;
                
                const mainImage = document.getElementById('mascote-image');
                mainImage.src = '';
                mainImage.style.display = 'none';
                
                const preview = document.getElementById('image-preview');
                preview.src = '';
                preview.style.display = 'none';
                
                autoSave();
                mostrarFeedback('Imagem removida!', 'success');
            }
        }

        // ====================================================================
        // SISTEMA DE AUTO-SAVE
        // ====================================================================
        function autoSave() {
            const data = getMascoteData();
            localStorage.setItem('grimorio_mascote_autosave', JSON.stringify(data));
            mascoteData.lastAutoSave = new Date();
            
            // Atualizar displays
            updateVida();
            updateLealdade();
            updateAgilidade();
            updateForca();
            updatePercepcao();
            updateDefesa();
            updateNivelDisplay();
            updateCharCounters();
            
            // Atualizar último salvamento
            const lastSavedEl = document.getElementById('last-saved');
            if (lastSavedEl) {
                lastSavedEl.textContent = new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            }
        }

        // ====================================================================
        // FUNÇÕES DE IMPORT/EXPORT TXT
        // ====================================================================
        function importFromTXT() {
            document.getElementById('import-modal').classList.remove('hidden');
            document.getElementById('import-textarea').value = '';
            document.getElementById('import-textarea').focus();
        }

        function closeImportModal() {
            document.getElementById('import-modal').classList.add('hidden');
        }

        function processImport() {
            const text = document.getElementById('import-textarea').value.trim();
            if (!text) {
                mostrarFeedback('Cole o conteúdo do arquivo TXT para importar.', 'error');
                return;
            }
            
            try {
                const lines = text.split('\n');
                const data = {};
                
                let currentSection = '';
                let habilidades = [];
                let currentHabilidade = null;
                
                for (let line of lines) {
                    line = line.trim();
                    
                    if (line.startsWith('===')) {
                        currentSection = line.replace(/=/g, '').trim().toLowerCase();
                        continue;
                    }
                    
                    if (line.includes(':')) {
                        const [key, ...valueParts] = line.split(':');
                        const value = valueParts.join(':').trim();
                        
                        switch(currentSection) {
                            case 'informações básicas':
                                if (key.trim() === 'Nome') data.nome = value;
                                if (key.trim() === 'Tipo') data.tipo = value;
                                if (key.trim() === 'Nível') data.nivel = parseInt(value);
                                break;
                                
                            case 'status':
                                if (key.trim() === 'Vida') {
                                    const [atual, max] = value.split('/').map(v => parseInt(v.trim()));
                                    data.vidaAtual = atual;
                                    data.vidaMax = max;
                                }
                                if (key.trim() === 'Lealdade') data.lealdade = parseInt(value);
                                if (key.trim() === 'Agilidade') data.agilidade = parseInt(value);
                                if (key.trim() === 'Força') data.forca = parseInt(value);
                                if (key.trim() === 'Percepção') data.percepcao = parseInt(value);
                                if (key.trim() === 'Defesa') data.defesa = parseInt(value);
                                break;
                                
                            case 'habilidades':
                                if (line.includes('(Custo:')) {
                                    if (currentHabilidade) habilidades.push(currentHabilidade);
                                    
                                    const habMatch = line.match(/(\d+)\.\s*(.+?)\s*\(Custo:\s*(\d+)/);
                                    if (habMatch) {
                                        currentHabilidade = {
                                            nome: habMatch[2].trim(),
                                            custo: parseInt(habMatch[3])
                                        };
                                    }
                                } else if (currentHabilidade && line) {
                                    currentHabilidade.descricao = (currentHabilidade.descricao || '') + line + ' ';
                                }
                                break;
                                
                            case 'descrições':
                                if (key.trim() === 'Aparência') data.aparencia = value;
                                if (key.trim() === 'Personalidade') data.personalidade = value;
                                break;
                                
                            case 'história':
                                data.historia = line;
                                break;
                        }
                    } else if (line && currentSection === 'história') {
                        data.historia = (data.historia || '') + line + '\n';
                    }
                }
                
                if (currentHabilidade) {
                    habilidades.push(currentHabilidade);
                }
                
                if (habilidades.length > 0) {
                    data.habilidades = habilidades.map((h, i) => ({
                        id: Date.now() + i,
                        nome: h.nome || `Habilidade ${i + 1}`,
                        descricao: h.descricao || '',
                        custo: h.custo || 0
                    }));
                }
                
                // Mapear tipo
                if (data.tipo) {
                    const tipoMap = {
                        'Canino': 'canino',
                        'Felino': 'felino',
                        'Ave': 'ave'
                    };
                    data.tipoSelecionado = tipoMap[data.tipo] || 'canino';
                }
                
                loadMascoteData(data);
                closeImportModal();
                mostrarFeedback('Mascote importado com sucesso!', 'success');
                
            } catch (error) {
                console.error('Erro ao importar:', error);
                mostrarFeedback('Erro ao importar arquivo TXT. Verifique o formato.', 'error');
            }
        }

        function downloadTXT() {
            const data = getMascoteData();
            let txtContent = '';
            
            // Informações básicas
            txtContent += '=== INFORMAÇÕES BÁSICAS ===\n\n';
            txtContent += `Nome: ${data.nome || 'Sem nome'}\n`;
            txtContent += `Tipo: ${getTipoNome(data.tipoSelecionado)}\n`;
            txtContent += `Nível: ${data.nivel}\n\n`;
            
            // Status
            txtContent += '=== STATUS ===\n\n';
            txtContent += `Vida: ${data.vidaAtual}/${data.vidaMax}\n`;
            txtContent += `Lealdade: ${data.lealdade}%\n`;
            txtContent += `Agilidade: ${data.agilidade}\n`;
            txtContent += `Força: ${data.forca}\n`;
            txtContent += `Percepção: ${data.percepcao}\n`;
            txtContent += `Defesa: ${data.defesa}\n\n`;
            
            // Habilidades
            if (data.habilidades.length > 0) {
                txtContent += '=== HABILIDADES ===\n\n';
                data.habilidades.forEach((skill, index) => {
                    txtContent += `${index + 1}. ${skill.nome} (Custo: ${skill.custo})\n`;
                    if (skill.descricao) {
                        txtContent += `   ${skill.descricao}\n`;
                    }
                    txtContent += '\n';
                });
            }
            
            // Descrições
            txtContent += '=== DESCRIÇÕES ===\n\n';
            txtContent += `Aparência:\n${data.aparencia || 'Não descrita.'}\n\n`;
            txtContent += `Personalidade:\n${data.personalidade || 'Não descrita.'}\n\n`;
            
            // História
            if (data.historia) {
                txtContent += '=== HISTÓRIA ===\n\n';
                txtContent += data.historia + '\n\n';
            }
            
            // Metadados
            txtContent += '=== METADADOS ===\n\n';
            txtContent += `Exportado em: ${new Date().toLocaleString()}\n`;
            txtContent += `Sistema: Grimório Digital - Mascote\n`;
            
            const blob = new Blob([txtContent], { type: 'text/plain;charset=utf-8' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `mascote_${data.nome || 'sem_nome'}_${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            mostrarFeedback('Ficha exportada como TXT!', 'success');
        }

        function getTipoNome(tipoId) {
            const tipos = {
                'canino': 'Canino',
                'felino': 'Felino',
                'ave': 'Ave'
            };
            return tipos[tipoId] || 'Desconhecido';
        }

        // ====================================================================
        // SISTEMA DE PERSISTÊNCIA
        // ====================================================================
        function getMascoteData() {
            return {
                nome: document.getElementById('mascote-nome').value,
                tipoSelecionado: mascoteData.tipoSelecionado,
                nivel: parseInt(document.getElementById('mascote-nivel').value) || 1,
                vidaAtual: parseInt(document.getElementById('vida-atual').value) || 50,
                vidaMax: parseInt(document.getElementById('vida-max').value) || 50,
                lealdade: parseInt(document.getElementById('input-lealdade').value) || 80,
                agilidade: parseInt(document.getElementById('input-agilidade').value) || 70,
                forca: parseInt(document.getElementById('input-forca').value) || 60,
                percepcao: parseInt(document.getElementById('input-percepcao').value) || 65,
                defesa: parseInt(document.getElementById('input-defesa').value) || 55,
                aparencia: document.getElementById('mascote-aparencia').value,
                personalidade: document.getElementById('mascote-personalidade').value,
                historia: document.getElementById('mascote-historia').value,
                habilidades: mascoteData.skills,
                imageData: mascoteData.imageData,
                timestamp: new Date().toISOString(),
                version: '1.0'
            };
        }

        function saveLocal() {
            const data = getMascoteData();
            localStorage.setItem('grimorio_mascote_completo', JSON.stringify(data));
            
            const btn = document.getElementById('btn-save-local');
            const originalHTML = btn.innerHTML;
            
            btn.disabled = true;
            btn.innerHTML = `<i data-lucide="loader-2" class="w-4 h-4 animate-spin"></i>`;
            lucide.createIcons();

            setTimeout(() => {
                btn.innerHTML = `<i data-lucide="check" class="w-4 h-4"></i>`;
                lucide.createIcons();
                
                document.getElementById('last-saved').textContent = 
                    new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                
                setTimeout(() => {
                    btn.disabled = false;
                    btn.innerHTML = originalHTML;
                    lucide.createIcons();
                }, 2000);
            }, 800);
            
            mostrarFeedback("Mascote salvo localmente!", "success");
        }

        function loadMascoteData(data) {
            // Carregar dados básicos
            if (data.nome) document.getElementById('mascote-nome').value = data.nome;
            if (data.nivel) document.getElementById('mascote-nivel').value = data.nivel;
            if (data.vidaAtual) document.getElementById('vida-atual').value = data.vidaAtual;
            if (data.vidaMax) document.getElementById('vida-max').value = data.vidaMax;
            if (data.lealdade) document.getElementById('input-lealdade').value = data.lealdade;
            if (data.agilidade) document.getElementById('input-agilidade').value = data.agilidade;
            if (data.forca) document.getElementById('input-forca').value = data.forca;
            if (data.percepcao) document.getElementById('input-percepcao').value = data.percepcao;
            if (data.defesa) document.getElementById('input-defesa').value = data.defesa;
            if (data.aparencia) document.getElementById('mascote-aparencia').value = data.aparencia;
            if (data.personalidade) document.getElementById('mascote-personalidade').value = data.personalidade;
            if (data.historia) document.getElementById('mascote-historia').value = data.historia;
            
            // Carregar tipo
            if (data.tipoSelecionado) {
                mascoteData.tipoSelecionado = data.tipoSelecionado;
                selectTipoCriatura(data.tipoSelecionado);
            }
            
            // Carregar habilidades
            if (data.habilidades) {
                mascoteData.skills = data.habilidades;
                renderSkills();
            }
            
            // Carregar imagem
            if (data.imageData) {
                mascoteData.imageData = data.imageData;
                const mainImage = document.getElementById('mascote-image');
                mainImage.src = data.imageData;
                mainImage.style.display = 'block';
            }
            
            // Atualizar todos os displays
            updateVida();
            updateLealdade();
            updateAgilidade();
            updateForca();
            updatePercepcao();
            updateDefesa();
            updateNivelDisplay();
            updateCharCounters();
        }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('grimorio_mascote_completo');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    loadMascoteData(data);
                    
                    // Atualizar último salvamento
                    if (data.timestamp) {
                        const date = new Date(data.timestamp);
                        document.getElementById('last-saved').textContent = 
                            date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                    }
                    
                    mostrarFeedback('Dados carregados!', 'success');
                } catch (error) {
                    console.error('Erro ao carregar:', error);
                    resetToDefault();
                }
            } else {
                resetToDefault();
            }
        }

        // ====================================================================
        // SISTEMA DE CONFIRMAÇÃO
        // ====================================================================
        function showConfirmModal(title, message, actionCallback) {
            document.getElementById('confirm-title').textContent = title;
            document.getElementById('confirm-message').textContent = message;
            document.getElementById('confirm-action-btn').onclick = function() {
                closeConfirmModal(true);
                if (actionCallback) actionCallback();
            };
            document.getElementById('confirm-modal').classList.remove('hidden');
        }

        function closeConfirmModal(confirmed) {
            document.getElementById('confirm-modal').classList.add('hidden');
            if (pendingAction && confirmed) {
                pendingAction();
            }
            pendingAction = null;
        }

        function askReset() {
            showConfirmModal(
                'Resetar Mascote',
                'Tem certeza que deseja resetar todos os dados do mascote? Esta ação não pode ser desfeita.',
                resetMascote
            );
        }

        // ====================================================================
        // FUNÇÕES DE RESET
        // ====================================================================
        function resetToDefault() {
            document.getElementById('mascote-nome').value = '';
            document.getElementById('mascote-nivel').value = 1;
            document.getElementById('vida-atual').value = 50;
            document.getElementById('vida-max').value = 50;
            document.getElementById('input-lealdade').value = 80;
            document.getElementById('input-agilidade').value = 70;
            document.getElementById('input-forca').value = 60;
            document.getElementById('input-percepcao').value = 65;
            document.getElementById('input-defesa').value = 55;
            document.getElementById('mascote-aparencia').value = '';
            document.getElementById('mascote-personalidade').value = '';
            document.getElementById('mascote-historia').value = '';
            
            mascoteData.skills = [];
            renderSkills();
            
            mascoteData.tipoSelecionado = 'canino';
            selectTipoCriatura('canino');
            
            mascoteData.imageData = null;
            const mainImage = document.getElementById('mascote-image');
            mainImage.src = '';
            mainImage.style.display = 'none';
            
            updateAllDisplays();
        }

        function resetMascote() {
            resetToDefault();
            
            localStorage.removeItem('grimorio_mascote_completo');
            localStorage.removeItem('grimorio_mascote_autosave');
            
            document.getElementById('last-saved').textContent = 'Não salvo';
            mostrarFeedback("Mascote resetado com sucesso!", "success");
        }

        // ====================================================================
        // FEEDBACK
        // ====================================================================
        function mostrarFeedback(mensagem, tipo = 'info') {
            const existing = document.querySelectorAll('.feedback-mascote');
            existing.forEach(el => el.remove());
            
            const feedback = document.createElement('div');
            feedback.className = `feedback-mascote px-4 py-3 rounded-lg border shadow-lg ${
                tipo === 'success' ? 'bg-green-900/30 border-green-700 text-green-300' :
                tipo === 'warning' ? 'bg-yellow-900/30 border-yellow-700 text-yellow-300' :
                tipo === 'error' ? 'bg-red-900/30 border-red-700 text-red-300' :
                'bg-blue-900/30 border-blue-700 text-blue-300'
            }`;
            
            feedback.innerHTML = `
                <div class="flex items-center gap-2">
                    <i data-lucide="${
                        tipo === 'success' ? 'check-circle' :
                        tipo === 'warning' ? 'alert-triangle' :
                        tipo === 'error' ? 'x-circle' : 'info'
                    }" class="w-4 h-4"></i>
                    <span class="font-medium">${mensagem}</span>
                </div>
            `;
            
            document.body.appendChild(feedback);
            lucide.createIcons();
            
            setTimeout(() => {
                feedback.style.opacity = '0';
                feedback.style.transform = 'translateX(20px)';
                setTimeout(() => feedback.remove(), 500);
            }, 3000);
        }

        // ====================================================================
        // INICIALIZAÇÃO
        // ====================================================================
        window.addEventListener('load', () => {
            // Carregar dados
            loadFromLocalStorage();
            
            // Configurar eventos
            document.getElementById('vida-atual').addEventListener('input', updateVida);
            document.getElementById('vida-max').addEventListener('input', updateVida);
            document.getElementById('input-lealdade').addEventListener('input', updateLealdade);
            document.getElementById('input-agilidade').addEventListener('input', updateAgilidade);
            document.getElementById('input-forca').addEventListener('input', updateForca);
            document.getElementById('input-percepcao').addEventListener('input', updatePercepcao);
            document.getElementById('input-defesa').addEventListener('input', updateDefesa);
            document.getElementById('mascote-nivel').addEventListener('input', updateNivelDisplay);
            
            document.getElementById('mascote-aparencia').addEventListener('input', updateCharCounters);
            document.getElementById('mascote-personalidade').addEventListener('input', updateCharCounters);
            document.getElementById('mascote-historia').addEventListener('input', updateCharCounters);
            
            // Auto-save nos campos
            const autoSaveFields = [
                'mascote-nome', 'mascote-nivel', 'vida-atual', 'vida-max',
                'input-lealdade', 'input-agilidade', 'input-forca',
                'input-percepcao', 'input-defesa', 'mascote-aparencia',
                'mascote-personalidade', 'mascote-historia'
            ];
            
            autoSaveFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.addEventListener('input', autoSave);
                }
            });
            
            lucide.createIcons();
        });

        function updateAllDisplays() {
            updateVida();
            updateLealdade();
            updateAgilidade();
            updateForca();
            updatePercepcao();
            updateDefesa();
            updateNivelDisplay();
            updateCharCounters();
        }

    </script>
</body>
</html>