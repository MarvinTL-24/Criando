<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grimório Digital</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Inter:wght@300;400;500&family=JetBrains+Mono:wght@400&display=swap" rel="stylesheet">
    <script src="grimorio-sync.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        cinzel: ['Cinzel', 'serif'],
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        theme: {
                            bg: '#0a0a0c',
                            panel: '#0f0f12',
                            border: '#2a2a2e',
                            text: '#e8e4dc',
                            blue: '#4a9eff',
                            orange: '#ff6b35',
                            green: '#10b981',
                            purple: '#8b5cf6',
                            pink: '#ec4899',
                            yellow: '#f59e0b'
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #0a0a0c; color: #e8e4dc; }
        
        /* Scrollbar Customizada */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0a0a0c; }
        ::-webkit-scrollbar-thumb { background: #2a2a2e; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #4a9eff; }

        /* Efeitos de Glow */
        .text-shadow-glow { text-shadow: 0 0 10px rgba(74, 158, 255, 0.5); }
        .hover-glow-blue:hover { box-shadow: 0 0 20px rgba(74, 158, 255, 0.15); border-color: rgba(74, 158, 255, 0.5); }
        .hover-glow-orange:hover { box-shadow: 0 0 20px rgba(255, 107, 53, 0.15); border-color: rgba(255, 107, 53, 0.5); }

        /* Animações */
        .anim-entry {
            animation: fadeInUp 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        .anim-delay-1 { animation-delay: 0.2s; }
        .anim-delay-2 { animation-delay: 0.4s; }
        .anim-delay-3 { animation-delay: 0.6s; }

        @keyframes fadeInUp {
            to { opacity: 1; transform: translateY(0); }
        }

        /* Classes para Dropdown */
        .dropdown-content {
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.2s ease-in-out;
            pointer-events: none;
        }

        .dropdown-content.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
            pointer-events: auto;
        }

        .chevron { transition: transform 0.3s ease; }
        .chevron.rotate { transform: rotate(180deg); }

        /* Botão de Salvamento */
        .save-btn {
            position: relative;
            overflow: hidden;
        }
        
        .save-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1, 1) translate(-50%);
            transform-origin: 50% 50%;
        }
        
        .save-btn:focus:not(:active)::after {
            animation: ripple 1s ease-out;
        }
        
        @keyframes ripple {
            0% {
                transform: scale(0, 0);
                opacity: 0.5;
            }
            100% {
                transform: scale(20, 20);
                opacity: 0;
            }
        }
        
        /* Feedback de Salvamento */
        .save-feedback {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body class="min-h-screen font-sans flex flex-col">

    <!-- Navegação Superior (Hub) -->
    <nav class="w-full bg-[#0f0f12]/95 backdrop-blur-sm border-b border-theme-border sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex items-center justify-center flex-wrap" id="nav-container">
                
                <!-- FICHA -->
                <a href="ficha.html" class="flex items-center gap-2 px-5 py-4 text-[#e8e4dc] font-medium tracking-wide transition-all duration-300 hover:text-[#4a9eff] hover:bg-[#1a1a1e] border-b-2 border-transparent hover:border-[#4a9eff]">
                    <i data-lucide="scroll-text" class="w-4 h-4"></i>
                    <span class="font-cinzel">Ficha</span>
                </a>

                <!-- Perfil -->
                <a href="perfil.html" class="flex items-center gap-2 px-5 py-4 text-[#e8e4dc] font-medium tracking-wide transition-all duration-300 hover:text-[#ff6b35] hover:bg-[#1a1a1e] border-b-2 border-transparent hover:border-[#ff6b35]">
                    <i data-lucide="zap" class="w-4 h-4"></i>
                    <span class="font-cinzel">Perfil</span>
                </a>

                <!-- CONJUNTO (Habilidades + Itens + Proficiências) -->
                <div class="relative group dropdown-container">
                    <button onclick="toggleMenu('menu-conjunto', this)" class="nav-btn flex items-center gap-2 px-5 py-4 text-[#e8e4dc] font-medium tracking-wide transition-all duration-300 hover:text-[#4a9eff] hover:bg-[#1a1a1e] border-b-2 border-transparent hover:border-[#4a9eff]">
                        <i data-lucide="layers" class="w-4 h-4"></i>
                        <span class="font-cinzel">Conjunto</span>
                        <i data-lucide="chevron-down" class="w-4 h-4 chevron"></i>
                    </button>
                    <div id="menu-conjunto" class="dropdown-content absolute top-full left-0 min-w-[220px] bg-[#0f0f12] border border-[#2a2a2e] shadow-2xl shadow-black/50 z-50">
                        <a href="habilidades.html" class="flex items-center gap-2 px-5 py-3 text-[#a0a0a0] text-sm transition-all duration-300 hover:bg-[#4a9eff]/10 hover:text-[#4a9eff] hover:pl-7 border-l-2 border-transparent hover:border-[#4a9eff]">
                            <i data-lucide="sparkles" class="w-3 h-3"></i> Habilidades
                        </a>
                        <a href="inventario.html" class="flex items-center gap-2 px-5 py-3 text-[#a0a0a0] text-sm transition-all duration-300 hover:bg-[#4a9eff]/10 hover:text-[#4a9eff] hover:pl-7 border-l-2 border-transparent hover:border-[#4a9eff]">
                            <i data-lucide="backpack" class="w-3 h-3"></i> Itens
                        </a>
                        <a href="proficiencias.html" class="flex items-center gap-2 px-5 py-3 text-[#a0a0a0] text-sm transition-all duration-300 hover:bg-[#4a9eff]/10 hover:text-[#4a9eff] hover:pl-7 border-l-2 border-transparent hover:border-[#4a9eff]">
                            <i data-lucide="award" class="w-3 h-3"></i> Proficiências
                        </a>
                    </div>
                </div>

                <!-- MASCOTE -->
                <a href="mascote.html" class="flex items-center gap-2 px-5 py-4 text-[#e8e4dc] font-medium tracking-wide transition-all duration-300 hover:text-[#10b981] hover:bg-[#1a1a1e] border-b-2 border-transparent hover:border-[#10b981]">
                    <i data-lucide="dog" class="w-4 h-4"></i>
                    <span class="font-cinzel">Mascote</span>
                </a>

                <!-- SISTEMA (Classe + Perfis + Backup) -->
                <div class="relative group dropdown-container">
                    <button onclick="toggleMenu('menu-sistema', this)" class="nav-btn flex items-center gap-2 px-5 py-4 text-[#e8e4dc] font-medium tracking-wide transition-all duration-300 hover:text-[#8b5cf6] hover:bg-[#1a1a1e] border-b-2 border-transparent hover:border-[#8b5cf6]">
                        <i data-lucide="settings" class="w-4 h-4"></i>
                        <span class="font-cinzel">Sistema</span>
                        <i data-lucide="chevron-down" class="w-4 h-4 chevron"></i>
                    </button>
                    <div id="menu-sistema" class="dropdown-content absolute top-full left-0 min-w-[220px] bg-[#0f0f12] border border-[#2a2a2e] shadow-2xl shadow-black/50 z-50">
                        <a href="classe.html" class="flex items-center gap-2 px-5 py-3 text-[#a0a0a0] text-sm transition-all duration-300 hover:bg-[#8b5cf6]/10 hover:text-[#8b5cf6] hover:pl-7 border-l-2 border-transparent hover:border-[#8b5cf6]">
                            <i data-lucide="swords" class="w-3 h-3"></i> Classes
                        </a>
                        <a href="perfil.html" class="flex items-center gap-2 px-5 py-3 text-[#a0a0a0] text-sm transition-all duration-300 hover:bg-[#ec4899]/10 hover:text-[#ec4899] hover:pl-7 border-l-2 border-transparent hover:border-[#ec4899]">
                            <i data-lucide="users" class="w-3 h-3"></i> Perfis
                        </a>
                        <a href="backup.html" class="flex items-center gap-2 px-5 py-3 text-[#a0a0a0] text-sm transition-all duration-300 hover:bg-[#f59e0b]/10 hover:text-[#f59e0b] hover:pl-7 border-l-2 border-transparent hover:border-[#f59e0b]">
                            <i data-lucide="hard-drive" class="w-3 h-3"></i> Backup
                        </a>
                    </div>
                </div>

            </div>
        </div>
        <div class="h-[2px] bg-gradient-to-r from-transparent via-[#4a9eff] to-transparent"></div>
    </nav>

    <!-- Container principal -->
    <main class="flex-grow">
        <!-- Banner Hero -->
        <div class="relative w-full h-[30vh] min-h-[250px] overflow-hidden anim-entry">
            <div class="absolute inset-0 bg-cover bg-center" style="background-image: url('https://images.unsplash.com/photo-1518709268805-4e9042af9f23?w=1600&q=80');"></div>
            <div class="absolute inset-0 bg-gradient-to-t from-[#0a0a0c] via-[#0a0a0c]/60 to-transparent"></div>
            <div class="absolute inset-0 bg-gradient-to-r from-[#0a0a0c]/80 via-transparent to-[#0a0a0c]/80"></div>
            
            <div class="absolute inset-0 flex flex-col items-center justify-center z-10">
                <h1 class="font-cinzel text-4xl md:text-6xl font-bold text-theme-text tracking-widest text-shadow-glow mb-4">Grimório Digital</h1>
                
                <div class="w-32 h-[2px] bg-gradient-to-r from-transparent via-theme-blue to-transparent"></div>
                
                <p class="text-[#a0a0a0] mt-3 tracking-[0.3em] text-sm font-light">HUB CENTRAL</p>
            </div>
            
            <div class="absolute bottom-0 left-0 right-0 h-[1px] bg-gradient-to-r from-transparent via-theme-blue/50 to-transparent"></div>
        </div>
        
        <!-- SEÇÃO PERFIL ATIVO -->
        <div class="max-w-6xl mx-auto px-4 py-8 anim-entry anim-delay-1">
            <div class="bg-theme-panel border border-theme-border p-6 rounded-lg hover:border-theme-blue/30 transition-all duration-300">
                <h3 class="flex items-center gap-2 font-cinzel text-lg font-semibold text-theme-blue mb-4">
                    <i data-lucide="user-check" class="w-5 h-5"></i>
                    Perfil Ativo
                </h3>
                
                <div id="perfil-ativo-container" class="flex flex-col md:flex-row items-center md:items-start gap-4 p-4 bg-[#0a0a0c] rounded border border-theme-border">
                    <!-- Avatar será carregado aqui -->
                    <div id="perfil-avatar" class="w-24 h-24 rounded-lg border-2 border-theme-border bg-cover bg-center flex-shrink-0 flex items-center justify-center overflow-hidden">
                        <i data-lucide="user" class="w-10 h-10 text-[#606060]"></i>
                    </div>
                    
                    <div class="flex-grow text-center md:text-left">
                        <!-- No index.html, adicione esta seção -->
                        <section class="bg-theme-panel border border-theme-border p-6 rounded-lg mb-6">
                            <h3 class="flex items-center gap-2 font-cinzel text-lg font-semibold mb-4">
                                <i data-lucide="user-check" class="w-5 h-5 text-theme-green"></i>
                                Perfil Ativo
                            </h3>
                            
                            <div id="active-profile-display" class="bg-[#0a0a0c] border border-theme-border p-4 rounded">
                                <!-- Conteúdo será carregado dinamicamente -->
                                <div class="text-center text-gray-500 py-8" id="no-active-profile">
                                    <i data-lucide="user-x" class="w-12 h-12 mx-auto mb-3 opacity-50"></i>
                                    <p>Nenhum perfil ativo</p>
                                    <p class="text-sm mt-2">Crie uma ficha para começar</p>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
        </div>

        <!-- OS 4 ÍCONES PRINCIPAIS -->
        <div class="max-w-6xl mx-auto px-4 pb-8 anim-entry anim-delay-2">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                
                <!-- ÍCONE 1: FICHA -->
                <a href="ficha.html" class="icon-card group p-5 bg-theme-panel border border-theme-border hover-glow-blue transition-all duration-300 rounded-lg h-full block">
                    <div class="flex flex-col items-center text-center h-full">
                        <div class="p-3 rounded-full bg-[#4a9eff]/10 text-theme-blue mb-4">
                            <i data-lucide="scroll-text" class="w-8 h-8"></i>
                        </div>
                        <h4 class="font-cinzel font-semibold text-white mb-2">Ficha</h4>
                        <p class="text-[#a0a0a0] text-sm mb-4">Lore & Corpo</p>
                        <div class="mt-auto w-full">
                            <div class="h-px bg-theme-border mb-3"></div>
                            <div class="text-center">
                                <p class="text-xs text-[#a0a0a0]">Aparência, História e Personalidade</p>
                            </div>
                        </div>
                    </div>
                </a>

                <!-- ÍCONE 2: STATUS -->
                <a href="perfil.html" class="icon-card group p-5 bg-theme-panel border border-theme-border hover-glow-orange transition-all duration-300 rounded-lg h-full block">
                    <div class="flex flex-col items-center text-center h-full">
                        <div class="p-3 rounded-full bg-[#ff6b35]/10 text-[#ff6b35] mb-4">
                            <i data-lucide="zap" class="w-8 h-8"></i>
                        </div>
                        <h4 class="font-cinzel font-semibold text-white mb-2">Perfil</h4>
                        <p class="text-[#a0a0a0] text-sm mb-4">Atributos & Progressão</p>
                        <div class="mt-auto w-full">
                            <div class="h-px bg-theme-border mb-3"></div>
                            <div class="text-center">
                                <p class="text-xs text-[#a0a0a0]">Atributos, Pontos de Vida e Mana</p>
                            </div>
                        </div>
                    </div>
                </a>

                <!-- ÍCONE 3: CONJUNTO -->
                <a href="habilidades.html" class="icon-card group p-5 bg-theme-panel border border-theme-border hover:border-[#4a9eff]/50 transition-all duration-300 rounded-lg h-full block">
                    <div class="flex flex-col items-center text-center h-full">
                        <div class="p-3 rounded-full bg-[#4a9eff]/10 text-[#4a9eff] mb-4">
                            <i data-lucide="layers" class="w-8 h-8"></i>
                        </div>
                        <h4 class="font-cinzel font-semibold text-white mb-2">Conjunto</h4>
                        <p class="text-[#a0a0a0] text-sm mb-4">Habilidades + Itens</p>
                        <div class="mt-auto w-full">
                            <div class="h-px bg-theme-border mb-3"></div>
                            <div class="text-center">
                                <p class="text-xs text-[#a0a0a0]">Poderes, Inventário e Talentos</p>
                            </div>
                        </div>
                    </div>
                </a>

                <!-- ÍCONE 4: MASCOTE -->
                <section class="bg-theme-panel border border-theme-border p-6 rounded-lg mb-6">
                    <h3 class="flex items-center gap-2 font-cinzel text-lg font-semibold mb-4">
                        <i data-lucide="dog" class="w-5 h-5 text-theme-pink"></i>
                        Mascote
                    </h3>
                    
                    <div id="mascote-display" class="bg-[#0a0a0c] border border-theme-border p-4 rounded">
                        <!-- Conteúdo será carregado dinamicamente -->
                        <div class="text-center text-gray-500 py-8" id="no-mascote">
                            <i data-lucide="dog" class="w-12 h-12 mx-auto mb-3 opacity-50"></i>
                            <p>Nenhum mascote criado</p>
                            <p class="text-sm mt-2">Crie um companheiro para seu personagem</p>
                            <button onclick="window.location.href='mascote.html'" 
                                    class="mt-3 px-4 py-2 bg-gradient-to-r from-theme-pink to-purple-600 rounded text-white text-sm font-semibold hover:opacity-90 transition-opacity">
                                <i data-lucide="plus" class="w-3 h-3 inline mr-1"></i>
                                Criar Mascote
                            </button>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <!-- EXPLICAÇÕES DETALHADAS -->
        <div class="max-w-6xl mx-auto px-4 pb-12 anim-entry anim-delay-3">
            <div class="grid md:grid-cols-2 gap-6">
                
                <!-- FICHA -->
                <div class="bg-theme-panel border border-theme-border p-6 hover:border-theme-blue/30 transition-all duration-500 rounded">
                    <div class="flex items-center gap-3 mb-4 pb-4 border-b border-theme-border">
                        <div class="p-2 rounded bg-[#4a9eff]/15 text-theme-blue">
                            <i data-lucide="scroll-text" class="w-5 h-5"></i>
                        </div>
                        <h3 class="font-cinzel text-lg font-semibold text-theme-blue">Ficha (Lore & Corpo)</h3>
                    </div>
                    <div class="space-y-4">
                        <div>
                            <span class="text-theme-text font-medium block">Aparência Detalhada:</span>
                            <p class="text-[#808080] text-sm leading-relaxed mt-1">Slots de corpo para definir cada aspecto físico do personagem - rosto, cabelo, olhos, marcas, cicatrizes, tatuagens e características únicas.</p>
                        </div>
                        <div>
                            <span class="text-theme-text font-medium block">História e Personalidade:</span>
                            <p class="text-[#808080] text-sm leading-relaxed mt-1">Backstory completa, motivações, traços de personalidade, relações importantes e eventos marcantes que definem quem o personagem é.</p>
                        </div>
                        <div>
                            <span class="text-theme-text font-medium block">Identidade Visual:</span>
                            <p class="text-[#808080] text-sm leading-relaxed mt-1">Upload de imagem do personagem, cores características e elementos visuais que representam sua essência.</p>
                        </div>
                    </div>
                </div>

                <!-- STATUS -->
                <div class="bg-theme-panel border border-theme-border p-6 hover:border-[#ff6b35]/30 transition-all duration-500 rounded">
                    <div class="flex items-center gap-3 mb-4 pb-4 border-b border-theme-border">
                        <div class="p-2 rounded bg-[#ff6b35]/15 text-[#ff6b35]">
                            <i data-lucide="zap" class="w-5 h-5"></i>
                        </div>
                        <h3 class="font-cinzel text-lg font-semibold text-[#ff6b35]">Perfil (Atributos & Progressão do personagem)</h3>
                    </div>
                    <div class="space-y-4">
                        <div>
                            <span class="text-theme-text font-medium block">Atributos Numéricos:</span>
                            <p class="text-[#808080] text-sm leading-relaxed mt-1">Força, Agilidade, Inteligência, Constituição, Carisma e outros atributos essenciais para o sistema de jogo.</p>
                        </div>
                        <div>
                            <span class="text-theme-text font-medium block">Pontos de Vida e Mana:</span>
                            <p class="text-[#808080] text-sm leading-relaxed mt-1">Sistema completo de recursos, com valores máximos, atuais e regeneração baseada em atributos.</p>
                        </div>
                        <div>
                            <span class="text-theme-text font-medium block">Progressão de Nível:</span>
                            <p class="text-[#808080] text-sm leading-relaxed mt-1">Experiência, pontos de atributo disponíveis, melhorias e evolução do personagem ao longo da campanha.</p>
                        </div>
                    </div>
                </div>

                <!-- CONJUNTO -->
                <div class="bg-theme-panel border border-theme-border p-6 hover:border-[#4a9eff]/30 transition-all duration-500 rounded">
                    <div class="flex items-center gap-3 mb-4 pb-4 border-b border-theme-border">
                        <div class="p-2 rounded bg-[#4a9eff]/15 text-[#4a9eff]">
                            <i data-lucide="layers" class="w-5 h-5"></i>
                        </div>
                        <h3 class="font-cinzel text-lg font-semibold text-[#4a9eff]">Conjunto (Habilidades + Itens + Proficiências)</h3>
                    </div>
                    <div class="space-y-4">
                        <div>
                            <span class="text-theme-text font-medium block">Habilidades de Combate:</span>
                            <p class="text-[#808080] text-sm leading-relaxed mt-1">Poderes ativos, magias, técnicas especiais com custos, efeitos e cooldowns para uso em batalha.</p>
                        </div>
                        <div>
                            <span class="text-theme-text font-medium block">Inventário Completo:</span>
                            <p class="text-[#808080] text-sm leading-relaxed mt-1">Sistema de slots para armas, armaduras, acessórios, consumíveis e itens mágicos com estatísticas detalhadas.</p>
                        </div>
                        <div>
                            <span class="text-theme-text font-medium block">Proficiências e Talentos:</span>
                            <p class="text-[#808080] text-sm leading-relaxed mt-1">Perícias sociais, ofícios, especializações em armas/magias e bônus passivos que definem o expertise do personagem.</p>
                        </div>
                    </div>
                </div>

                <!-- MASCOTE -->
                <div class="bg-theme-panel border border-theme-border p-6 hover:border-[#10b981]/30 transition-all duration-500 rounded">
                    <div class="flex items-center gap-3 mb-4 pb-4 border-b border-theme-border">
                        <div class="p-2 rounded bg-[#10b981]/15 text-[#10b981]">
                            <i data-lucide="dog" class="w-5 h-5"></i>
                        </div>
                        <h3 class="font-cinzel text-lg font-semibold text-[#10b981]">Mascote (Companheiro)</h3>
                    </div>
                    <div class="space-y-4">
                        <div>
                            <span class="text-theme-text font-medium block">Sistema Próprio:</span>
                            <p class="text-[#808080] text-sm leading-relaxed mt-1">O mascote possui sua própria ficha com status, nível, experiência e habilidades únicas.</p>
                        </div>
                        <div>
                            <span class="text-theme-text font-medium block">Equipamentos Exclusivos:</span>
                            <p class="text-[#808080] text-sm leading-relaxed mt-1">Itens especiais que apenas o mascote pode utilizar, oferecendo bônus e habilidades adicionais.</p>
                        </div>
                        <div>
                            <span class="text-theme-text font-medium block">Vínculo com o Personagem:</span>
                            <p class="text-[#808080] text-sm leading-relaxed mt-1">Habilidades conjuntas que são desbloqueadas conforme o nível de vínculo entre personagem e mascote aumenta.</p>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <footer class="border-t border-theme-border py-8 mt-auto">
        <div class="flex justify-center items-center gap-4">
            <div class="w-16 h-[1px] bg-gradient-to-r from-transparent to-[#4a9eff]/50"></div>
            <i data-lucide="sword" class="w-4 h-4 text-[#4a9eff]/50 rotate-90 md:rotate-0"></i>
            <div class="w-16 h-[1px] bg-gradient-to-l from-transparent to-[#4a9eff]/50"></div>
        </div>
        <p class="text-center text-[#606060] text-xs mt-4">Grimório Digital - Sistema de RPG v1.0</p>
    </footer>

    <!-- Botão de Salvamento Flutuante (aparecerá em todas as páginas) -->
    <div id="floating-save-btn" class="fixed bottom-6 right-6 z-50 hidden">
        <button onclick="salvarPerfilAtivo()" class="save-btn flex items-center gap-2 px-4 py-3 bg-theme-green hover:bg-[#0ea271] text-white rounded-lg shadow-lg transition-all duration-300 hover:shadow-xl">
            <i data-lucide="save" class="w-4 h-4"></i>
            <span class="font-medium">Salvar Perfil</span>
        </button>
    </div>

    <!-- Feedback de Salvamento -->
    <div id="save-feedback" class="fixed top-6 right-6 z-50 hidden">
        <div class="save-feedback flex items-center gap-2 px-4 py-3 bg-theme-panel border border-theme-green text-theme-green rounded-lg shadow-lg">
            <i data-lucide="check-circle" class="w-4 h-4"></i>
            <span>Perfil salvo com sucesso!</span>
        </div>
    </div>

    <script>
        // 1. Inicializar Ícones Lucide
        if (window.lucide) {
            lucide.createIcons();
        }

        // 2. Lógica dos Dropdowns
        function toggleMenu(menuId, btnElement) {
            const menu = document.getElementById(menuId);
            const chevron = btnElement.querySelector('.chevron');
            const isActive = menu.classList.contains('active');

            closeAllMenus();

            if (!isActive) {
                menu.classList.add('active');
                if(chevron) chevron.classList.add('rotate');
            }
        }

        function closeAllMenus() {
            document.querySelectorAll('.dropdown-content').forEach(el => {
                el.classList.remove('active');
            });
            document.querySelectorAll('.chevron').forEach(el => {
                el.classList.remove('rotate');
            });
        }

        window.addEventListener('click', function(e) {
            if (!e.target.closest('.dropdown-container')) {
                closeAllMenus();
            }
        });

        // 3. Sistema de Perfil Ativo
        function carregarPerfilAtivo() {
            const dadosSalvos = localStorage.getItem('grimorio_perfil_ativo');
            const containerVazio = document.getElementById('perfil-sem-dados');
            const containerComDados = document.getElementById('perfil-com-dados');
            const avatarContainer = document.getElementById('perfil-avatar');
            const floatingSaveBtn = document.getElementById('floating-save-btn');
            
            // Verificar se estamos em uma página de edição (ficha, status, etc)
            const paginasEdicao = ['ficha.html', 'status.html', 'habilidades.html', 'inventario.html', 
                                  'proficiencias.html', 'mascote.html', 'classe.html'];
            const paginaAtual = window.location.pathname.split('/').pop();
            
            if (paginasEdicao.includes(paginaAtual)) {
                if (floatingSaveBtn) {
                    floatingSaveBtn.classList.remove('hidden');
                }
            }
            
            if (!dadosSalvos) {
                // Mostrar estado vazio
                if (containerVazio) containerVazio.classList.remove('hidden');
                if (containerComDados) containerComDados.classList.add('hidden');
                if (avatarContainer) {
                    avatarContainer.style.backgroundImage = '';
                    avatarContainer.innerHTML = '<i data-lucide="user" class="w-10 h-10 text-[#606060]"></i>';
                    if (window.lucide) lucide.createIcons();
                }
                return;
            }
            
            try {
                const dados = JSON.parse(dadosSalvos);
                
                // Mostrar container com dados
                if (containerVazio) containerVazio.classList.add('hidden');
                if (containerComDados) containerComDados.classList.remove('hidden');
                
                // Preencher informações
                if (document.getElementById('perfil-nome')) {
                    document.getElementById('perfil-nome').textContent = dados.nome || dados['inp-nome'] || 'Sem nome';
                }
                if (document.getElementById('perfil-titulo')) {
                    document.getElementById('perfil-titulo').textContent = dados.titulo || dados['inp-titulo'] || 'Aventureiro sem título';
                }
                if (document.getElementById('perfil-classe')) {
                    document.getElementById('perfil-classe').textContent = dados.classe || dados['inp-classe'] || 'Sem classe';
                }
                if (document.getElementById('perfil-raca')) {
                    document.getElementById('perfil-raca').textContent = dados.raca || dados['inp-raca'] || 'Sem raça';
                }
                if (document.getElementById('perfil-nivel')) {
                    const nivel = dados.nivel || dados['inp-nivel'] || 1;
                    document.getElementById('perfil-nivel').textContent = `Nível ${nivel}`;
                }
                
                // Carregar avatar
                if (avatarContainer && dados.avatar) {
                    avatarContainer.style.backgroundImage = `url(${dados.avatar})`;
                    avatarContainer.style.backgroundSize = 'cover';
                    avatarContainer.style.backgroundPosition = 'center';
                    avatarContainer.innerHTML = '';
                }
                
                // Formatar datas
                if (dados.dataCriacao) {
                    const dataCriacao = new Date(dados.dataCriacao);
                    document.getElementById('perfil-criacao').textContent = 
                        `Criado em ${dataCriacao.toLocaleDateString('pt-BR')}`;
                }
                
                if (dados.ultimaAtualizacao) {
                    const dataAtualizacao = new Date(dados.ultimaAtualizacao);
                    const agora = new Date();
                    const diferencaMin = Math.floor((agora - dataAtualizacao) / (1000 * 60));
                    
                    let textoAtualizacao;
                    if (diferencaMin < 1) {
                        textoAtualizacao = 'Atualizado agora';
                    } else if (diferencaMin < 60) {
                        textoAtualizacao = `Atualizado há ${diferencaMin} min`;
                    } else if (diferencaMin < 1440) {
                        textoAtualizacao = `Atualizado hoje às ${dataAtualizacao.toLocaleTimeString('pt-BR', {hour: '2-digit', minute:'2-digit'})}`;
                    } else {
                        textoAtualizacao = `Atualizado em ${dataAtualizacao.toLocaleDateString('pt-BR')}`;
                    }
                    
                    document.getElementById('perfil-atualizacao').textContent = textoAtualizacao;
                }
                
            } catch (error) {
                console.error('Erro ao carregar perfil ativo:', error);
                // Em caso de erro, mostrar estado vazio
                if (containerVazio) containerVazio.classList.remove('hidden');
                if (containerComDados) containerComDados.classList.add('hidden');
            }
        }
        
        // 4. Função de Salvamento Universal
        function salvarPerfilAtivo() {
            const dadosSalvos = localStorage.getItem('grimorio_perfil_ativo');
            
            if (!dadosSalvos) {
                mostrarFeedback('Erro: Nenhum perfil encontrado para salvar.', 'error');
                return;
            }
            
            try {
                let dados = JSON.parse(dadosSalvos);
                
                // Atualizar data de modificação
                dados.ultimaAtualizacao = new Date().toISOString();
                
                // Coletar dados específicos da página atual
                const paginaAtual = window.location.pathname.split('/').pop();
                
                switch(paginaAtual) {
                    case 'ficha.html':
                        // Coletar dados da ficha
                        dados = coletarDadosFicha(dados);
                        break;
                    case 'status.html':
                        // Coletar dados do status
                        dados = coletarDadosStatus(dados);
                        break;
                    case 'habilidades.html':
                        // Coletar dados de habilidades
                        dados = coletarDadosHabilidades(dados);
                        break;
                    case 'inventario.html':
                        // Coletar dados do inventário
                        dados = coletarDadosInventario(dados);
                        break;
                    case 'proficiencias.html':
                        // Coletar dados de proficiências
                        dados = coletarDadosProficiencias(dados);
                        break;
                    case 'mascote.html':
                        // Coletar dados do mascote
                        dados = coletarDadosMascote(dados);
                        break;
                    case 'classe.html':
                        // Coletar dados da classe
                        dados = coletarDadosClasse(dados);
                        break;
                }
                
                // Salvar no localStorage
                localStorage.setItem('grimorio_perfil_ativo', JSON.stringify(dados));
                
                // Mostrar feedback
                mostrarFeedback('Perfil salvo com sucesso!', 'success');
                
                // Atualizar display
                setTimeout(carregarPerfilAtivo, 500);
                
            } catch (error) {
                console.error('Erro ao salvar perfil:', error);
                mostrarFeedback('Erro ao salvar perfil.', 'error');
            }
        }
        
        // Funções auxiliares para coletar dados (serão implementadas nas páginas específicas)
        function coletarDadosFicha(dadosAtuais) {
            // Esta função será sobrescrita na página ficha.html
            return dadosAtuais;
        }
        
        function coletarDadosStatus(dadosAtuais) {
            // Esta função será sobrescrita na página status.html
            return dadosAtuais;
        }
        
        function coletarDadosHabilidades(dadosAtuais) {
            // Esta função será sobrescrita na página habilidades.html
            return dadosAtuais;
        }
        
        function coletarDadosInventario(dadosAtuais) {
            // Esta função será sobrescrita na página inventario.html
            return dadosAtuais;
        }
        
        function coletarDadosProficiencias(dadosAtuais) {
            // Esta função será sobrescrita na página proficiencias.html
            return dadosAtuais;
        }
        
        function coletarDadosMascote(dadosAtuais) {
            // Esta função será sobrescrita na página mascote.html
            return dadosAtuais;
        }
        
        function coletarDadosClasse(dadosAtuais) {
            // Esta função será sobrescrita na página classe.html
            return dadosAtuais;
        }
        
        function criarNovoPerfil() {
            // Redirecionar para criação de ficha
            window.location.href = 'ficha.html?novo=true';
        }
        
        function entrarNoPerfil(tipo) {
            const dadosSalvos = localStorage.getItem('grimorio_perfil_ativo');
            if (!dadosSalvos) {
                mostrarFeedback('Nenhum perfil ativo encontrado. Crie um perfil primeiro.', 'error');
                return;
            }
            
            if (tipo === 'ficha') {
                window.location.href = 'ficha.html';
            } else if (tipo === 'status') {
                window.location.href = 'status.html';
            }
        }
        
        function mostrarFeedback(mensagem, tipo) {
            const feedback = document.getElementById('save-feedback');
            const icones = {
                success: 'check-circle',
                error: 'alert-circle',
                info: 'info'
            };
            
            if (feedback) {
                feedback.innerHTML = `
                    <div class="save-feedback flex items-center gap-2 px-4 py-3 bg-theme-panel border ${tipo === 'success' ? 'border-theme-green text-theme-green' : tipo === 'error' ? 'border-red-500 text-red-500' : 'border-theme-blue text-theme-blue'} rounded-lg shadow-lg">
                        <i data-lucide="${icones[tipo] || 'info'}" class="w-4 h-4"></i>
                        <span>${mensagem}</span>
                    </div>
                `;
                
                feedback.classList.remove('hidden');
                if (window.lucide) lucide.createIcons();
                
                setTimeout(() => {
                    feedback.classList.add('hidden');
                }, 3000);
            }
        }

        // 5. Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            // Carregar perfil ativo
            carregarPerfilAtivo();
            
            // Atualizar periodicamente (caso o perfil seja editado em outra aba)
            setInterval(carregarPerfilAtivo, 5000);
            
            // Adicionar evento de teclado para salvar (Ctrl+S)
            document.addEventListener('keydown', function(e) {
                if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                    e.preventDefault();
                    salvarPerfilAtivo();
                }
            });
        });
        
        // 6. Sistema de Perfis (funções globais)
        window.getActiveProfileData = function() {
            const dados = localStorage.getItem('grimorio_perfil_ativo');
            return dados ? JSON.parse(dados) : null;
        };
        
        window.hasActiveProfile = function() {
            return localStorage.getItem('grimorio_perfil_ativo') !== null;
        };
        
        window.getActiveProfileInfo = function() {
            const dados = window.getActiveProfileData();
            if (!dados) return null;
            
            return {
                id: dados.id || 'default',
                nome: dados.nome || dados['inp-nome'] || 'Sem nome',
                classe: dados.classe || dados['inp-classe'] || 'Não definida',
                raca: dados.raca || dados['inp-raca'] || 'Não definida',
                nivel: dados.nivel || dados['inp-nivel'] || 1,
                avatar: dados.avatar || null
            };
        };
        // No index.html, função para carregar perfil ativo
        function loadActiveProfileDisplay() {
            const display = document.getElementById('active-profile-display');
            const noProfile = document.getElementById('no-active-profile');
            
            try {
                const perfis = localStorage.getItem('rpg_sistema_perfis');
                const perfilAtivoId = localStorage.getItem('perfil_ativo');
                
                if (!perfis || !perfilAtivoId) {
                    noProfile.classList.remove('hidden');
                    return;
                }
                
                const perfisObj = JSON.parse(perfis);
                const perfilAtivo = perfisObj[perfilAtivoId];
                
                if (!perfilAtivo) {
                    noProfile.classList.remove('hidden');
                    return;
                }
                
                noProfile.classList.add('hidden');
                
                const dados = perfilAtivo.dados || {};
                const basico = dados.basico || {};
                
                display.innerHTML = `
                    <div class="flex items-start gap-4">
                        <div class="w-16 h-16 rounded-full bg-gradient-to-br from-theme-orange to-theme-red flex items-center justify-center">
                            <i data-lucide="user" class="w-8 h-8 text-white"></i>
                        </div>
                        <div class="flex-1">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h4 class="font-cinzel font-bold text-xl text-white">${basico.nome || 'Personagem'}</h4>
                                    <p class="text-gray-400">
                                        ${basico.raca || 'Raça'} • ${basico.classe || 'Classe'} • Nível ${dados.progressao?.nivel || 1}
                                    </p>
                                </div>
                                <span class="px-2 py-1 text-xs rounded-full bg-theme-green/20 text-theme-green">
                                    Ativo
                                </span>
                            </div>
                            
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mt-4">
                                <div class="text-center">
                                    <div class="text-2xl font-bold text-theme-orange">${dados.atributos?.forca || 0}</div>
                                    <div class="text-xs text-gray-500">Força</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-2xl font-bold text-theme-blue">${dados.atributos?.inteligencia || 0}</div>
                                    <div class="text-xs text-gray-500">Inteligência</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-2xl font-bold text-theme-green">${dados.progressao?.xp_atual || 0}</div>
                                    <div class="text-xs text-gray-500">XP</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-2xl font-bold text-theme-purple">${dados.destino?.valor || '--'}</div>
                                    <div class="text-xs text-gray-500">Destino</div>
                                </div>
                            </div>
                            
                            <div class="flex gap-2 mt-4">
                                <button onclick="window.location.href='perfil.html'" 
                                    class="flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-theme-blue/20 hover:bg-theme-blue/30 text-theme-blue border border-theme-blue/30 rounded text-sm transition-colors">
                                    <i data-lucide="eye" class="w-3 h-3"></i>
                                    Ver Perfil
                                </button>
                                <button onclick="window.location.href='ficha.html'" 
                                    class="flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-theme-orange/20 hover:bg-theme-orange/30 text-theme-orange border border-theme-orange/30 rounded text-sm transition-colors">
                                    <i data-lucide="edit-3" class="w-3 h-3"></i>
                                    Editar Ficha
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                lucide.createIcons();
                
            } catch (error) {
                console.error('Erro ao carregar perfil ativo:', error);
                noProfile.classList.remove('hidden');
            }
        }

        // Chame esta função quando a página carregar
        window.addEventListener('load', loadActiveProfileDisplay);
    // No index.html, função para carregar mascote
    function loadMascoteDisplay() {
        const display = document.getElementById('mascote-display');
        const noMascote = document.getElementById('no-mascote');
        
        try {
            // Primeiro tentar carregar do perfil ativo
            const perfis = localStorage.getItem('rpg_sistema_perfis');
            const perfilAtivoId = localStorage.getItem('perfil_ativo');
            
            let mascoteData = null;
            
            if (perfis && perfilAtivoId) {
                const perfisObj = JSON.parse(perfis);
                const perfilAtivo = perfisObj[perfilAtivoId];
                
                if (perfilAtivo?.dados?.mascote) {
                    mascoteData = perfilAtivo.dados.mascote;
                }
            }
            
            // Se não encontrar no perfil, tentar localStorage
            if (!mascoteData) {
                const mascoteLocal = localStorage.getItem('grimorio_mascote_index');
                if (mascoteLocal) {
                    mascoteData = JSON.parse(mascoteLocal);
                }
            }
            
            if (!mascoteData || !mascoteData.temMascote) {
                noMascote.classList.remove('hidden');
                return;
            }
            
            noMascote.classList.add('hidden');
            
            display.innerHTML = `
                <div class="flex items-start gap-4">
                    <div class="w-16 h-16 rounded-full flex items-center justify-center border-2" 
                        style="border-color: ${mascoteData.cor || '#ec4899'}80; background: ${mascoteData.cor || '#ec4899'}20">
                        <i data-lucide="${mascoteData.icone || 'dog'}" 
                        style="color: ${mascoteData.cor || '#ec4899'}" 
                        class="w-8 h-8"></i>
                    </div>
                    <div class="flex-1">
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="font-cinzel font-bold text-xl text-white">${mascoteData.nome || 'Mascote'}</h4>
                                <p class="text-gray-400">
                                    ${mascoteData.tipo || 'Tipo'} • Nível ${mascoteData.nivel || 1}
                                </p>
                            </div>
                            <span class="px-2 py-1 text-xs rounded-full bg-theme-pink/20 text-theme-pink">
                                Companheiro
                            </span>
                        </div>
                        
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-3 mt-4">
                            <div class="text-center p-2 bg-theme-bg rounded border border-theme-border">
                                <div class="text-lg font-bold text-theme-green">${mascoteData.nivel || 1}</div>
                                <div class="text-xs text-gray-500">Nível</div>
                            </div>
                            <div class="text-center p-2 bg-theme-bg rounded border border-theme-border">
                                <div class="text-lg font-bold" style="color: ${mascoteData.cor || '#ec4899'}">${mascoteData.tipo || 'Tipo'}</div>
                                <div class="text-xs text-gray-500">Tipo</div>
                            </div>
                            <div class="text-center p-2 bg-theme-bg rounded border border-theme-border">
                                <div class="text-lg font-bold text-theme-blue">Vinculado</div>
                                <div class="text-xs text-gray-500">Ao Personagem</div>
                            </div>
                        </div>
                        
                        <div class="flex gap-2 mt-4">
                            <button onclick="window.location.href='mascote.html'" 
                                    class="flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-theme-pink/20 hover:bg-theme-pink/30 text-theme-pink border border-theme-pink/30 rounded text-sm transition-colors">
                                <i data-lucide="eye" class="w-3 h-3"></i>
                                Ver Mascote
                            </button>
                            <button onclick="window.location.href='mascote.html'" 
                                    class="flex-1 flex items-center justify-center gap-2 px-3 py-2 bg-theme-orange/20 hover:bg-theme-orange/30 text-theme-orange border border-theme-orange/30 rounded text-sm transition-colors">
                                <i data-lucide="edit-3" class="w-3 h-3"></i>
                                Editar
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            lucide.createIcons();
            
        } catch (error) {
            console.error('Erro ao carregar mascote:', error);
            noMascote.classList.remove('hidden');
        }
    }

    // Chame esta função junto com as outras no load
    window.addEventListener('load', function() {
        loadActiveProfileDisplay();
        loadMascoteDisplay(); // Adicionar esta linha
    });
    // shared.js - Coloque em todas as páginas
    class GrimorioSaveSystem {
        static saveCharacter(data) {
            localStorage.setItem('grimorio_character_data', JSON.stringify(data));
            this.notifyUpdate('character');
        }
        
        static saveMascot(data) {
            localStorage.setItem('grimorio_mascot_data', JSON.stringify(data));
            this.notifyUpdate('mascot');
        }
        
        static saveItems(data) {
            localStorage.setItem('grimorio_items_data', JSON.stringify(data));
            this.notifyUpdate('items');
        }
        
        static loadCharacter() {
            const data = localStorage.getItem('grimorio_character_data');
            return data ? JSON.parse(data) : null;
        }
        
        static loadMascot() {
            const data = localStorage.getItem('grimorio_mascot_data');
            return data ? JSON.parse(data) : null;
        }
        
        static loadItems() {
            const data = localStorage.getItem('grimorio_items_data');
            return data ? JSON.parse(data) : [];
        }
        
        static notifyUpdate(type) {
            // Dispara evento customizado
            const event = new CustomEvent('grimorio-update', {
                detail: { type: type, timestamp: Date.now() }
            });
            window.dispatchEvent(event);
        }
        
        static exportAll() {
            const allData = {
                character: this.loadCharacter(),
                mascot: this.loadMascot(),
                items: this.loadItems(),
                version: '2.0',
                exportDate: new Date().toISOString()
            };
            
            return JSON.stringify(allData, null, 2);
        }
        
        static importAll(jsonString) {
            try {
                const data = JSON.parse(jsonString);
                
                if (data.character) {
                    this.saveCharacter(data.character);
                }
                if (data.mascot) {
                    this.saveMascot(data.mascot);
                }
                if (data.items) {
                    this.saveItems(data.items);
                }
                
                return true;
            } catch (error) {
                console.error('Erro ao importar:', error);
                return false;
            }
        }
    }

    // Listener para atualizações em tempo real
    window.addEventListener('grimorio-update', function(event) {
        console.log('Dados atualizados:', event.detail.type);
        // Atualiza a página atual com os novos dados
        refreshCurrentPage();
    });

    // Função para detectar mudanças no localStorage de outras abas
    window.addEventListener('storage', function(event) {
        if (event.key.startsWith('grimorio_')) {
            location.reload(); // Recarrega para mostrar dados atualizados
        }
    });
    </script>
</body>
</html>